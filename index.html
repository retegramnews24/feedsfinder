<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lettore Video</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #000;
            font-family: Arial, sans-serif;
            overflow-x: hidden;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        #video-container {
            width: 100%;
            position: relative;
            flex-grow: 1;
        }
        
        #video-player {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .custom-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.7));
            padding: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            transform: scale(0.5);
            transform-origin: bottom center;
        }
        
        .control-btn {
            background: rgba(30, 30, 30, 0.8);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 0 5px;
            font-size: 18px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        
        .control-btn:active {
            background: rgba(50, 50, 50, 0.9);
        }
        
        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            margin: 5px 0;
            cursor: pointer;
        }
        
        .progress-bar {
            height: 100%;
            background: #007bff;
            border-radius: 4px;
            width: 0%;
        }
        
        .time-display {
            color: white;
            font-size: 12px;
            margin: 0 10px;
        }
        
        .volume-container {
            display: flex;
            align-items: center;
            margin-left: 10px;
        }
        
        .volume-slider {
            width: 60px;
            margin-left: 5px;
        }
        
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 16px;
        }
        
        /* Stili per schermi piÃ¹ piccoli */
        @media (max-width: 480px) {
            .custom-controls {
                padding: 5px;
            }
            
            .control-btn {
                width: 35px;
                height: 35px;
                margin: 0 3px;
            }
            
            .time-display {
                font-size: 10px;
                margin: 0 5px;
            }
            
            .volume-slider {
                width: 40px;
            }
        }
    </style>
</head>
<body>
    <div id="video-container">
        <video id="video-player" playsinline>
            Il tuo browser non supporta la riproduzione video.
        </video>
        <div id="loading">Caricamento video...</div>
        
        <div class="custom-controls">
            <button class="control-btn" id="play-pause">â–¶</button>
            <span class="time-display" id="current-time">0:00</span>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <span class="time-display" id="duration">0:00</span>
            <div class="volume-container">
                <button class="control-btn" id="mute">ðŸ”Š</button>
                <input type="range" min="0" max="1" step="0.1" value="1" class="volume-slider" id="volume">
            </div>
            <button class="control-btn" id="fullscreen">â›¶</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const video = document.getElementById('video-player');
            const playPauseBtn = document.getElementById('play-pause');
            const currentTimeEl = document.getElementById('current-time');
            const durationEl = document.getElementById('duration');
            const progressBar = document.getElementById('progress-bar');
            const progressContainer = document.querySelector('.progress-container');
            const muteBtn = document.getElementById('mute');
            const volumeSlider = document.getElementById('volume');
            const fullscreenBtn = document.getElementById('fullscreen');
            const loadingEl = document.getElementById('loading');
            
            const videoUrl = 'https://cineverse.g-mana.live/media/ac7cff3c-5bc3-4745-ac4d-56aadb586d00/profile/1/profileManifest.m3u8';
            
            // Controlla se il browser supporta HLS nativamente
            if (video.canPlayType('application/vnd.apple.mpegurl')) {
                // Supporto nativo per HLS (Safari)
                video.src = videoUrl;
                video.addEventListener('loadedmetadata', function() {
                    loadingEl.style.display = 'none';
                    durationEl.textContent = formatTime(video.duration);
                });
            } else if (Hls.isSupported()) {
                // Usa hls.js per browser che non supportano HLS nativamente
                const hls = new Hls();
                hls.loadSource(videoUrl);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    loadingEl.style.display = 'none';
                    durationEl.textContent = formatTime(video.duration);
                });
            } else {
                loadingEl.textContent = 'Il tuo browser non supporta la riproduzione di questo video.';
            }
            
            // Formatta il tempo in minuti:secondi
            function formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
            }
            
            // Aggiorna il tempo corrente
            video.addEventListener('timeupdate', function() {
                currentTimeEl.textContent = formatTime(video.currentTime);
                const progress = (video.currentTime / video.duration) * 100;
                progressBar.style.width = `${progress}%`;
            });
            
            // Play/Pause
            playPauseBtn.addEventListener('click', function() {
                if (video.paused) {
                    video.play();
                    playPauseBtn.textContent = 'âšâš';
                } else {
                    video.pause();
                    playPauseBtn.textContent = 'â–¶';
                }
            });
            
            // Clicca sulla barra di progresso per saltare a un punto specifico
            progressContainer.addEventListener('click', function(e) {
                const rect = progressContainer.getBoundingClientRect();
                const percent = (e.clientX - rect.left) / rect.width;
                video.currentTime = percent * video.duration;
            });
            
            // Mute/Unmute
            muteBtn.addEventListener('click', function() {
                video.muted = !video.muted;
                muteBtn.textContent = video.muted ? 'ðŸ”‡' : 'ðŸ”Š';
            });
            
            // Controllo volume
            volumeSlider.addEventListener('input', function() {
                video.volume = volumeSlider.value;
                video.muted = (video.volume === 0);
                muteBtn.textContent = video.muted ? 'ðŸ”‡' : 'ðŸ”Š';
            });
            
            // Schermo intero
            fullscreenBtn.addEventListener('click', function() {
                if (!document.fullscreenElement) {
                    if (videoContainer.requestFullscreen) {
                        videoContainer.requestFullscreen();
                    } else if (videoContainer.mozRequestFullScreen) {
                        videoContainer.mozRequestFullScreen();
                    } else if (videoContainer.webkitRequestFullscreen) {
                        videoContainer.webkitRequestFullscreen();
                    } else if (videoContainer.msRequestFullscreen) {
                        videoContainer.msRequestFullscreen();
                    }
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    } else if (document.mozCancelFullScreen) {
                        document.mozCancelFullScreen();
                    } else if (document.webkitExitFullscreen) {
                        document.webkitExitFullscreen();
                    } else if (document.msExitFullscreen) {
                        document.msExitFullscreen();
                    }
                }
            });
            
            // Gestione errori
            video.addEventListener('error', function() {
                loadingEl.textContent = 'Errore nel caricamento del video.';
            });
        });
    </script>
</body>
</html>
